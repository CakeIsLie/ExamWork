using EASendMail;
using System;

namespace ExJobb
{
    class Program
    {
        static void Main(string[] args)
        {
            try
            {
                SmtpMail oMail = new SmtpMail("TryIt");

                //sender email address
                oMail.From = " ";
                //recipient email address
                oMail.To = " ";

                //email subject
                oMail.Subject = "test email from c# project";
                //email body
                oMail.TextBody = "this is a test email sent from c# project, if you get this by mistake please tell me so I can fix it";

                //SMTP server address
                SmtpServer oServer = new SmtpServer(" ");

                //SSL/TLS connection
                //ConnectTryTLS means if server supports SSL/TLS, SSL/TLS will be used automatically
                oServer.ConnectType = SmtpConnectType.ConnectTryTLS;

                //If your SMTP server requires SSL/TLS connection on 25/587/465 port
                 oServer.Port = 25; // 25 or 587 or 465
                 oServer.ConnectType = SmtpConnectType.ConnectSSLAuto;

                Console.WriteLine("start to send email ...");

                SmtpClient oSmtp = new SmtpClient();
                oSmtp.SendMail(oServer, oMail);

                Console.WriteLine("email was sent successfully!");
            }
            catch (Exception ep)
            {
                Console.WriteLine("failed to send email with the following error:");
                Console.WriteLine(ep.Message);
            }
        }
    }
}
